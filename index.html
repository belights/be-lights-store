<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マーチング教室グッズ注文システム</title>
    <style>
        /* （元のCSSそのまま省略） */
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🎺 マーチング教室グッズ注文システム 🎺</h1>
            <p>お気に入りのグッズを選んでご注文ください</p>
        </header>

        <div class="products-grid" id="products-grid"></div>

        <div class="customer-form">
            <h2>注文者情報</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>お名前 <span class="required">*</span></label>
                    <input type="text" id="customer-name" placeholder="山田太郎">
                </div>
                <div class="form-group">
                    <label>メールアドレス <span class="required">*</span></label>
                    <input type="email" id="customer-email" placeholder="example@email.com">
                </div>
                <div class="form-group">
                    <label>電話番号</label>
                    <input type="tel" id="customer-phone" placeholder="090-1234-5678">
                </div>
            </div>
        </div>

        <div class="order-summary">
            <h2>注文内容</h2>
            <div id="order-items"></div>
            <div class="total-section" id="total-section" style="display: none;">
                <div class="total-amount">
                    <span class="total-label">合計金額:</span>
                    <span class="total-value" id="total-amount">¥0</span>
                </div>
                <button class="order-btn" onclick="completeOrder()">注文を確定する</button>
            </div>
        </div>
    </div>

    <div class="success-modal" id="success-modal" style="display: none;">
        <div class="success-content">
            <div class="success-icon">✓</div>
            <h2>注文完了！</h2>
            <p>ご注文ありがとうございました。<br>確認メールを送信いたしました。</p>
            <div id="order-details"></div>
            <button class="new-order-btn" onclick="startNewOrder()">新しい注文を開始</button>
        </div>
    </div>

    <script>
        const products = [
            { id: 1, name: '缶バッジ', basePrice: 200, image: 'https://example.com/badge.jpg' },
            { id: 2, name: 'シール', basePrice: 100, image: 'https://example.com/sticker.jpg' },
            { id: 3, name: 'ランチバッグ', basePrice: 650, image: 'https://example.com/lunchbag.jpg' },
            { id: 4, name: '巾着（小）', basePrice: 500, image: 'https://example.com/pouch.jpg' },
            { id: 5, name: 'スウェットトレーナー(春夏用)', basePrice: 3000, hasSize: true, sizes: ['S','M','L','XL'], image: 'https://example.com/sweatshirt.jpg' },
            { id: 6, name: 'スウェットパンツ(春夏用)', basePrice: 4000, hasSize: true, sizes: ['S','M','L','XL'], image: 'https://example.com/sweatpants.jpg' }
        ];

        let cart = {};

        function renderProducts() {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                const cartItem = cart[product.id] || { quantity: 0, size: product.hasSize ? product.sizes[0] : null };
                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-price">¥${product.basePrice.toLocaleString()}</p>
                        ${product.hasSize ? `<label>サイズ:
                            <select id="size-${product.id}" onchange="updateSize(${product.id}, this.value)">
                                ${product.sizes.map(size => `<option value="${size}" ${cartItem.size === size ? 'selected' : ''}>${size}</option>`).join('')}
                            </select>
                        </label>` : ''}
                        <div class="quantity-controls">
                            <div class="quantity-buttons">
                                <button class="quantity-btn minus" onclick="removeFromCart(${product.id})" ${cartItem.quantity === 0 ? 'disabled' : ''}>−</button>
                                <span class="quantity-display">${cartItem.quantity}</span>
                                <button class="quantity-btn plus" onclick="addToCart(${product.id})">+</button>
                            </div>
                        </div>
                    </div>`;
                grid.appendChild(productCard);
            });
        }

        function updateSize(productId, size) {
            if (!cart[productId]) {
                cart[productId] = { quantity: 0, size };
            } else {
                cart[productId].size = size;
            }
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const size = product.hasSize ? document.getElementById(`size-${productId}`).value : null;

            if (!cart[productId]) cart[productId] = { quantity: 0, size };
            cart[productId].quantity += 1;
            if (size) cart[productId].size = size;

            renderProducts();
            renderOrderSummary();
        }

        function removeFromCart(productId) {
            if (cart[productId]?.quantity > 1) {
                cart[productId].quantity--;
            } else {
                delete cart[productId];
            }
            renderProducts();
            renderOrderSummary();
        }

        function renderOrderSummary() {
            const orderItems = document.getElementById('order-items');
            const totalSection = document.getElementById('total-section');

            if (Object.keys(cart).length === 0) {
                orderItems.innerHTML = '<div class="empty-cart">商品を選択してください</div>';
                totalSection.style.display = 'none';
                return;
            }

            let itemsHTML = '';
            let total = 0;

            Object.entries(cart).forEach(([id, entry]) => {
                const product = products.find(p => p.id === parseInt(id));
                const itemTotal = product.basePrice * entry.quantity;
                total += itemTotal;

                itemsHTML += `
                    <div class="order-item">
                        <div class="item-info">
                            <img src="${product.image}" alt="${product.name}" class="item-image">
                            <div class="item-details">
                                <h4>${product.name}</h4>
                                <p>¥${product.basePrice.toLocaleString()} × ${entry.quantity}${entry.size ? ` / サイズ: ${entry.size}` : ''}</p>
                            </div>
                        </div>
                        <div class="item-total">¥${itemTotal.toLocaleString()}</div>
                    </div>`;
            });

            orderItems.innerHTML = itemsHTML;
            document.getElementById('total-amount').textContent = `¥${total.toLocaleString()}`;
            totalSection.style.display = 'block';
        }

        function completeOrder() {
            const name = document.getElementById('customer-name').value;
            const email = document.getElementById('customer-email').value;
            const phone = document.getElementById('customer-phone').value;

            if (!name || !email) {
                alert('お名前とメールアドレスを入力してください。');
                return;
            }

            if (Object.keys(cart).length === 0) {
                alert('商品を選択してください。');
                return;
            }

            const total = Object.entries(cart).reduce((sum, [productId, entry]) => {
                const product = products.find(p => p.id === parseInt(productId));
                return sum + (product.basePrice * entry.quantity);
            }, 0);

            document.getElementById('order-details').innerHTML = `
                <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h3>注文詳細</h3>
                    <p><strong>注文者:</strong> ${name}</p>
                    <p><strong>メール:</strong> ${email}</p>
                    ${phone ? `<p><strong>電話:</strong> ${phone}</p>` : ''}
                    <p style="font-size: 1.2rem; font-weight: bold; color: #2196f3; margin-top: 10px;">
                        <strong>合計金額: ¥${total.toLocaleString()}</strong>
                    </p>
                </div>`;

            document.getElementById('success-modal').style.display = 'flex';
        }

        function startNewOrder() {
            cart = {};
            document.getElementById('customer-name').value = '';
            document.getElementById('customer-email').value = '';
            document.getElementById('customer-phone').value = '';
            document.getElementById('success-modal').style.display = 'none';
            renderProducts();
            renderOrderSummary();
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            renderOrderSummary();
        });
    </script>
</body>
</html>
